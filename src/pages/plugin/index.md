# Plugin setup

It's easy to expand the commander, analyse project files, and modifying the generated entry file by plugins.

## Install

First, create an empty folder, and `npm i pri`:

```bash
mkdir test;
cd test;
npm i pri --save;
```

Then, run `npx pri init`, and choose type: `Pri Plugin`.

```bash
npx pri init

# choose type: Pri Plugin
? Choose project type (Use arrow keys)
  Project
  Component
❯ Pri Plugin
  Cli
```

> No `npx`? Run `./node_modules/.bin/pri init`

## Plguin structor

```
.
├── .temp                     # Gitignored. Temporary file folder.
├── coverage                  # Gitignored. Code coverage folder.
├── dist                      # Gitignored. Dist folder, auto generated by `npm run build`.
├── tests                     # Tests folder.
├── src                       # Source files folder.
│   ├── plugin                # Plugin real path
│   └── index.ts              # Plugin entry.
└── priconfig.json            # Config file.
```

## Introduce

Pri plugin load by entry file `./src/index.ts`, here is three import method you should to implement:

```tsx
// Required. Normal plugin
export const getPlugin = () => import('./plugin');

// Optional. Web ui plugin
export const getUIPlugins = () => [import('./web-menu'), import('./web-store')];

// Required. Plugin config
export const getConfig = () => ({
  // Required. Plugin name
  name: 'pri-plugin-dob',
  // Optional. which plugin this plugin depend on. Plugin will be loaded after it dependences.
  dependencies: ['pri-plugin-login']
});
```

## Plug-in loading mode

All the pri-plugin should be named like `pri-plugin-*` or `@ali/pri-plugin-*`, for example:

- `pri-plugin-test`
- `pri-plugin-command-deploy`

For example:

```json
{
  "dependencies": {
    "pri": "*",
    "pri-plugin-test": "1.0.0"
  }
}
```

And when you installed `pri`, `pri-plugin-test` at the same time in your project , the plug-in will be automatically loaded when any `pri` scripts are executed.

> You can also install pri-plugins in pri-plugin! This is a way to merge plug-in.

## Debug plug-in

Change your npm path from project `package.json`:

```json
{
  "dependencies": {
    "pri": "*",
    "pri-plugin-test": "file:../pri-plugin-test"
  }
}
```

And run `npm start` both in plugin and project root.
